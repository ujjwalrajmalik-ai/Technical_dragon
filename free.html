<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Assets | Technical Dragon</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- CORE VARIABLES --- */
        :root {
            --color-bg: #050505;
            --color-primary: #FF0033; /* Red */
            --color-green: #00FF66;   /* Glowing Green */
            --color-white: #FFFFFF;
            --color-glass: rgba(255, 255, 255, 0.05);
            --color-glass-border: rgba(255, 255, 255, 0.15);
            --font-main: 'Montserrat', sans-serif;
            --font-tech: 'Orbitron', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--color-bg);
            color: var(--color-white);
            font-family: var(--font-main);
            overflow-x: hidden;
        }

        /* Copy Protection Class */
        .protected {
            user-select: none;
            -webkit-user-select: none;
            pointer-events: auto;
        }

        /* --- HEADER --- */
        .header-section {
            padding: 30px 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .page-title {
            font-family: var(--font-tech);
            font-size: 2rem;
            color: var(--color-white);
            text-shadow: 0 0 15px var(--color-primary);
            margin-bottom: 15px;
        }

        .subtitle {
            font-size: 0.9rem;
            line-height: 1.6;
            color: #ccc;
            max-width: 600px;
            margin: 0 auto;
        }

        .highlight-link {
            color: var(--color-primary);
            font-weight: 700;
            text-decoration: none;
            border-bottom: 1px dashed var(--color-primary);
            cursor: pointer;
        }

        /* --- LOADER BAR --- */
        .loader-wrapper {
            width: 100%;
            height: 4px;
            background: #222;
            margin-top: 25px;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .loader-bar {
            width: 0%;
            height: 100%;
            background: var(--color-primary);
            box-shadow: 0 0 10px var(--color-primary);
            transition: width 4s linear;
        }

        /* --- ASSETS GRID --- */
        .assets-container {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            align-items: center;
            margin-bottom: 80px;
            min-height: 50vh;
        }

        .asset-card {
            width: 100%;
            max-width: 400px;
            background: var(--color-glass);
            border: 1px solid var(--color-glass-border);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: fadeUp 0.6s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeUp {
            to { opacity: 1; transform: translateY(0); }
        }

        .asset-image-wrapper {
            width: 100%;
            height: 200px;
            background: #111;
            position: relative;
            overflow: hidden;
        }

        .asset-thumb {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .asset-card:hover .asset-thumb {
            transform: scale(1.05);
        }

        /* Adblock Msg */
        .adblock-msg {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #222;
            color: #666;
            font-size: 0.8rem;
            text-align: center;
            padding: 10px;
            z-index: -1;
        }

        .asset-details { padding: 15px; text-align: center; }
        .asset-name { font-weight: 800; font-size: 1.2rem; margin-bottom: 5px; text-transform: uppercase; }
        .asset-caption { font-size: 0.85rem; color: #aaa; margin-bottom: 15px; min-height: 2.4em; }

        /* Urgency Text */
        .urgency-text {
            font-size: 0.75rem; color: var(--color-primary); font-weight: 700;
            margin-bottom: 8px; display: block; letter-spacing: 0.5px;
            animation: pulse-red 2s infinite;
        }
        @keyframes pulse-red { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

        .price-btn {
            width: 100%; padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 700; color: white; cursor: pointer;
            border-radius: 8px; display: flex; justify-content: center;
            align-items: center; gap: 10px; transition: 0.2s;
        }
        .price-btn:active { transform: scale(0.98); background: rgba(255,255,255,0.2); }
        .price-strike { text-decoration: line-through; color: #888; font-size: 0.9rem; }
        .price-free {
            color: var(--color-green); font-size: 1.2rem;
            text-transform: uppercase; text-shadow: 0 0 5px rgba(0, 255, 102, 0.3);
        }

        /* Skeleton */
        .skeleton {
            background: linear-gradient(90deg, #111 25%, #1a1a1a 50%, #111 75%);
            background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 4px;
        }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px);
            z-index: 100; display: none; justify-content: center; align-items: center;
            padding: 20px; opacity: 0; transition: opacity 0.3s ease;
        }
        .modal-overlay.active { display: flex; opacity: 1; }

        .modal-content {
            background: #0f0f0f; border: 1px solid var(--color-glass-border);
            border-radius: 15px; width: 100%; max-width: 350px;
            padding: 20px; text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.active .modal-content { transform: scale(1); }

        .video-preview-container {
            position: relative; width: 100%; padding-bottom: 56.25%;
            background: #000; border-radius: 8px; overflow: hidden;
            margin-bottom: 15px; border: 1px solid #333; display: block;
        }
        .video-thumb { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }
        .play-icon {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 3rem; color: rgba(255, 255, 255, 0.8);
        }

        .modal-title { font-size: 1.1rem; margin-bottom: 15px; font-weight: 700; }
        .modal-divider { height: 1px; background: #333; width: 100%; margin: 15px 0; }
        .modal-close { margin-top: 15px; color: #888; font-size: 0.8rem; cursor: pointer; text-decoration: underline; }

        /* --- NEW: SCANNER & DOWNLOAD BUTTON --- */
        .scanner-ui {
            background: #111;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #333;
            display: none; /* Hidden by default */
        }

        .scan-bar-container {
            width: 100%;
            height: 6px;
            background: #222;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .scan-bar-fill {
            width: 0%;
            height: 100%;
            background: var(--color-green);
            box-shadow: 0 0 10px var(--color-green);
            transition: width 0.3s ease;
        }

        .status-text {
            font-family: var(--font-tech);
            font-size: 0.8rem;
            color: #aaa;
            letter-spacing: 1px;
        }

        .btn-download {
            display: none; /* Hidden until unlocked */
            width: 100%; padding: 15px;
            background: var(--color-green); color: #000;
            font-weight: 800; text-transform: uppercase;
            letter-spacing: 1px; text-decoration: none;
            border-radius: 8px; box-shadow: 0 0 15px var(--color-green);
            animation: pulse-green 2s infinite;
        }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 10px rgba(0, 255, 102, 0.5); }
            50% { box-shadow: 0 0 25px rgba(0, 255, 102, 0.8); }
        }

        /* --- FAB --- */
        .fab-container { position: fixed; bottom: 30px; right: 30px; z-index: 90; }
        .fab-main {
            width: 60px; height: 60px; background: var(--color-white);
            border-radius: 50%; color: var(--color-bg);
            display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
            cursor: pointer; transition: transform 0.3s ease;
        }
        .fab-options {
            position: absolute; bottom: 70px; right: 5px;
            display: flex; flex-direction: column; gap: 15px; pointer-events: none;
        }
        .fab-icon {
            width: 50px; height: 50px; border-radius: 50%;
            color: white; display: flex; justify-content: center; align-items: center;
            font-size: 1.2rem; text-decoration: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5); opacity: 0;
            transform: translateY(20px) scale(0.5);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .fab-container.active .fab-options { pointer-events: auto; }
        .fab-container.active .fab-icon { opacity: 1; transform: translateY(0) scale(1); }
        .fab-container.active .fab-icon:nth-child(3) { transition-delay: 0.05s; }
        .fab-container.active .fab-icon:nth-child(2) { transition-delay: 0.1s; }
        .fab-container.active .fab-icon:nth-child(1) { transition-delay: 0.15s; }
        .fab-container.active .fab-main { transform: rotate(45deg); background: var(--color-primary); color: white; }
        .icon-tg { background: #0088cc; }
        .icon-yt { background: #FF0000; }
        .icon-ig { background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); }

    </style>
</head>
<body>

    <div class="header-section">
        <h1 class="page-title">Free Assets</h1>
        <p class="subtitle">
            We are giving you free assets so give some support by following us on 
            <a id="link-insta" class="highlight-link" target="_blank">Instagram</a> 
            and subscribe on 
            <a id="link-yt" class="highlight-link" target="_blank">Youtube</a>
        </p>
    </div>

    <div class="loader-wrapper">
        <div class="loader-bar" id="loader"></div>
    </div>

    <div class="assets-container" id="assets-grid">
        <!-- Skeleton Loaders -->
        <div class="asset-card" style="opacity:1; transform:none;">
            <div class="skeleton" style="width:100%; height:200px;"></div>
            <div class="asset-details">
                <div class="skeleton" style="width:60%; height:20px; margin:10px auto;"></div>
                <div class="skeleton" style="width:80%; height:15px; margin:10px auto;"></div>
                <div class="skeleton" style="width:100%; height:40px; border-radius:8px;"></div>
            </div>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal-overlay" id="download-modal">
        <div class="modal-content">
            <a id="modal-video-link" href="#" target="_blank" class="video-preview-container">
                <img id="modal-video-thumb" class="video-thumb" src="" alt="Video Preview">
                <i class="fas fa-play-circle play-icon"></i>
            </a>

            <h3 class="modal-title">Our New Video is Out ðŸ¤¯</h3>
            <div class="modal-divider"></div>
            
            <!-- SCANNER UI (Initially Visible) -->
            <div class="scanner-ui" id="scanner">
                <div class="scan-bar-container">
                    <div class="scan-bar-fill" id="scan-bar"></div>
                </div>
                <div class="status-text" id="status-text">INITIALIZING...</div>
            </div>

            <!-- DOWNLOAD BTN (Initially Hidden) -->
            <a id="modal-download-btn" href="#" target="_blank" class="btn-download">
                GET FREE ASSET
            </a>

            <div class="modal-close" onclick="closeModal()">Close</div>
        </div>
    </div>

    <!-- FAB -->
    <div class="fab-container" id="fab">
        <div class="fab-options">
            <a id="fab-ig" href="#" target="_blank" class="fab-icon icon-ig"><i class="fab fa-instagram"></i></a>
            <a id="fab-yt" href="#" target="_blank" class="fab-icon icon-yt"><i class="fab fa-youtube"></i></a>
            <a id="fab-tg" href="#" target="_blank" class="fab-icon icon-tg"><i class="fab fa-telegram"></i></a>
        </div>
        <div class="fab-main" onclick="toggleFab(event)">
            <i class="fas fa-comment-dots"></i>
        </div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbyXtvJkxlZizHHvwQI3SkBIKd8Hwo-MGhq2q8yn3wyhjEDOxhC4-4ABcGyEGqY0GDzL/exec'; 

        window.addEventListener('load', () => {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#FF0033', '#FFFFFF', '#00FF66'] });
            document.body.style.overflow = 'hidden';
            const loader = document.getElementById('loader');
            setTimeout(() => { loader.style.width = '100%'; }, 50);
            setTimeout(() => { document.body.style.overflow = 'auto'; }, 4000);
            fetchData();
        });

        let globalLinks = { video: '#' }; 
        let scanTimer = null; // To clear interval if closed

        async function fetchData() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                if (data.status === "success") {
                    updateLinks(data.links);
                    renderAssets(data.assets);
                    globalLinks = data.links;
                }
            } catch (error) {
                console.error("Fetch Error:", error);
                document.getElementById('assets-grid').innerHTML = '<h3 style="color:#666;">Error loading assets. Please refresh.</h3>';
            }
        }

        function updateLinks(links) {
            document.getElementById('link-insta').href = links.instagram;
            document.getElementById('link-yt').href = links.youtube;
            document.getElementById('fab-ig').href = links.instagram;
            document.getElementById('fab-yt').href = links.youtube;
            document.getElementById('fab-tg').href = links.telegram;
        }

        function renderAssets(assets) {
            const grid = document.getElementById('assets-grid');
            grid.innerHTML = ''; 

            assets.forEach((asset, index) => {
                const slotsLeft = Math.floor(Math.random() * (16 - 3 + 1)) + 3; 
                const card = document.createElement('div');
                card.className = 'asset-card';
                card.style.animationDelay = `${index * 0.1}s`;
                card.innerHTML = `
                    <div class="asset-image-wrapper">
                        <div class="adblock-msg">Image Failed.<br>Disable AdBlock.</div>
                        <img src="${asset.thumbnail}" class="asset-thumb protected" alt="${asset.name}" draggable="false" oncontextmenu="return false;" onerror="this.style.opacity='0'">
                    </div>
                    <div class="asset-details">
                        <div class="asset-name">${asset.name}</div>
                        <div class="asset-caption">${asset.caption}</div>
                        <span class="urgency-text"><i class="fas fa-fire-alt"></i> Only ${slotsLeft} downloads left today</span>
                        <div class="price-btn" onclick="openModal('${asset.link}')">
                            <span class="price-strike">${asset.price}</span>
                            <span class="price-free">FREE</span>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // --- CORE: SCANNER + TIMER LOGIC ---
        function openModal(assetLink) {
            if (navigator.vibrate) navigator.vibrate(50); // Haptic

            const modal = document.getElementById('download-modal');
            const videoLink = globalLinks.video || '#';
            const btn = document.getElementById('modal-download-btn');
            const scanner = document.getElementById('scanner');
            const scanBar = document.getElementById('scan-bar');
            const statusText = document.getElementById('status-text');

            // 1. SETUP UI
            document.getElementById('modal-video-link').href = videoLink;
            btn.href = assetLink;
            btn.style.display = 'none'; // Hide button
            scanner.style.display = 'block'; // Show scanner
            scanBar.style.width = '0%'; // Reset bar
            statusText.innerText = 'INITIALIZING SCAN...';
            statusText.style.color = '#aaa';

            // 2. VIDEO THUMB
            let videoId = 'dQw4w9WgXcQ'; 
            try {
                const match = videoLink.match(/(?:youtu\.be\/|youtube\.com\/(?:.*v=|.*\/)|v\/)([^?&"'>]+)/);
                if (match && match[1]) videoId = match[1];
            } catch (e) {}
            document.getElementById('modal-video-thumb').src = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
            
            modal.classList.add('active');

            // 3. START ANIMATION SEQUENCE
            let phase = 0;
            if (scanTimer) clearInterval(scanTimer);
            
            // Phase 1: Virus Scan (3 Seconds)
            setTimeout(() => { scanBar.style.width = '40%'; statusText.innerText = 'SCANNING FOR VIRUSES...'; }, 500);
            setTimeout(() => { scanBar.style.width = '70%'; statusText.innerText = 'CHECKING REPOSITORY...'; }, 1500);
            setTimeout(() => { 
                scanBar.style.width = '100%'; 
                statusText.innerText = 'âœ“ SCAN COMPLETE. FILE SAFE.'; 
                statusText.style.color = '#00FF66'; // Green Text
            }, 3000);

            // Phase 2: Countdown (5 Seconds)
            let countdown = 5;
            setTimeout(() => {
                scanTimer = setInterval(() => {
                    statusText.innerText = `UNLOCKING LINK IN ${countdown}...`;
                    statusText.style.color = '#FF0033'; // Red Countdown
                    countdown--;

                    if (countdown < 0) {
                        clearInterval(scanTimer);
                        // Phase 3: Unlock
                        scanner.style.display = 'none';
                        btn.style.display = 'block'; // Show Button
                        if (navigator.vibrate) navigator.vibrate(100); // Success Vibe
                    }
                }, 1000);
            }, 3500); // Start countdown a bit after scan finishes
        }

        function closeModal() {
            document.getElementById('download-modal').classList.remove('active');
            if (scanTimer) clearInterval(scanTimer); // Stop timer if they close early
        }

        document.getElementById('download-modal').addEventListener('click', (e) => {
            if (e.target.id === 'download-modal') closeModal();
        });

        // FAB
        function toggleFab(event) {
            event.stopPropagation();
            document.getElementById('fab').classList.toggle('active');
        }
        document.addEventListener('click', (e) => {
            const fab = document.getElementById('fab');
            if (fab.classList.contains('active') && !fab.contains(e.target)) fab.classList.remove('active');
        });
    </script>
</body>
</html>
